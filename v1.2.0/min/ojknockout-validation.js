/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(["ojs/ojcore","jquery","knockout","ojs/ojknockout","ojs/ojmessaging"],function(b,f,a){b.zb=function(){};b.zb.nv="invalidComponentTracker";b.zb.UQ="ojoptionchange";b.zb.ol="messagesShown";b.zb.ln="messagesHidden";b.zb.kn="disabled";b.zb.xv="readOnly";b.zb.lo=function(d,c,e,g,f){e={};f=f.call()[b.zb.nv];var k;if(d===b.zb.kn||d===b.zb.xv)return k=f&&f.peek()||null,null!==k&&a.isWriteableObservable(f)&&k.lo.call(k,g,d,c)&&f.valueHasMutated(),e[d]=c,e};b.zb._init=function(a,b){var e={};e[a]=b;return e};
b.zb.O9=function(a,c,e,g){g=g.call();var f;a===b.zb.nv&&(f=g[a]?!0:!1)&&b.zb.Yia(a,g,c,e);return{}};b.zb.o$=function(d,c,e,g){c=f(c);g=g.call()[d];d===b.zb.nv&&c&&(c.off(b.zb.UQ,b.zb.O0),g&&a.isWriteableObservable(g)&&(d=g.peek(),d.aL.call(d,e)&&g.valueHasMutated()))};b.zb.O0=function(d,c){var e=d.data.XO,g,f=d.data.Q,k=c.option,l=c.value;(k===b.zb.ol||k===b.zb.ln)&&e&&a.isWriteableObservable(e)&&(g=e.peek())&&g.lo.call(g,f,k,l)&&e.valueHasMutated()};b.zb.Yia=function(d,c,e,g){d=c[d];var h,k;e=f(e);
if(a.isObservable(d))k=d.peek(),null==k&&(k=new b.Fb,d(k));else throw Error("Binding attribute "+b.zb.nv+" should be bound to a ko observable.");null!==k&&(a.isWriteableObservable(d)&&(c=g.call(g,"option",b.zb.ol),h=g.call(g,"option",b.zb.ln),k.lo.call(k,g,b.zb.ol,c),k.lo.call(k,g,b.zb.ln,h),d.valueHasMutated()),g={XO:d,Q:g},e.on(b.zb.UQ,g,b.zb.O0))};b.ia.jh().ph({"for":"editableValue",attributes:[b.zb.nv,b.zb.kn,b.zb.xv],init:b.zb._init,update:b.zb.lo,afterCreate:b.zb.O9,beforeDestroy:b.zb.o$});
b.Fb=function(){this.Init()};o_("InvalidComponentTracker",b.Fb,b);b.b.ga(b.Fb,b.b,"oj.InvalidComponentTracker");b.Fb.ol="messagesShown";b.Fb.ln="messagesHidden";b.Fb.kn="disabled";b.Fb.xv="readOnly";b.Fb.prototype.Init=function(){b.Fb.q.Init.call(this);this.Zt=[];this.Qn=[];this.rt=[];this.invalidHidden=this.invalidShown=!1};b.Fb.prototype.Y1=function(){var a=null,b=this,e=this.qD;this.invalidShown&&(a=this.KI());setTimeout(function(){(a=e===b.qD?a||b.KI():b.KI())&&a.call(a,"Focus")},1);return a?
!0:!1};b.b.g("InvalidComponentTracker.prototype.focusOnFirstInvalid",{Y1:b.Fb.prototype.Y1});b.Fb.prototype.showMessages=function(){var a,b,e;if(this.invalidHidden)for(b=this.rt.length,e=0;e<b;e++)this.rt[e]&&(a=this.Zt[e].call(a,"showMessages"))};b.b.g("InvalidComponentTracker.prototype.showMessages",{showMessages:b.Fb.prototype.showMessages});b.Fb.prototype.KI=function(){for(var a,b=0,e=this.Qn.length,b=0;b<e;b++)if(a=this.Qn[b])return this.Zt[b];return null};b.Fb.prototype.aL=function(a){var b=
-1,e=!1;f.each(this.Zt,function(e,f){0>b&&f===a&&(b=e)});0<=b&&(this.Zt.splice(b,1),this.Qn.splice(b,1),this.rt.splice(b,1),this.uM(),e=!0);return e};b.Fb.prototype.lo=function(a,c,e){var g=a.call(a,"isValid"),h=-1,k=!0,l;f.each(this.Zt,function(b,c){0>h&&c===a&&(h=b)});switch(c){case b.Fb.ol:case b.Fb.ln:l=!1;e&&(0>h&&(h=this.Zt.push(a)-1,this.lga(h,l)),!g&&b.Fb.RJ(e)&&(l=!0,c===b.Fb.ol&&(e=a.call(a,"option",b.Fb.kn),g=a.call(a,"option",b.Fb.xv),l=e||g?!1:!0)),k=this.Wx(c,h||0,l),this.uM(),k&&(void 0===
this.qD&&(this.qD=0),this.qD++));break;case b.Fb.kn:case b.Fb.xv:k=!1,e&&(k=this.Wx(b.Fb.ol,h||0,!1),k=this.Wx(b.Fb.ln,h||0,!1)||k,this.uM())}return k};b.Fb.prototype.lga=function(a,c){void 0===this.Qn[a]&&this.Wx(b.Fb.ol,a,c);void 0===this.rt[a]&&this.Wx(b.Fb.ln,a,c)};b.Fb.prototype.uM=function(){this.invalidShown=0<=this.Qn.indexOf(!0);this.invalidHidden=0<=this.rt.indexOf(!0)};b.Fb.prototype.Wx=function(a,c,e){var g=!1;a=a===b.Fb.ol?this.Qn:a===b.Fb.ln?this.rt:[];0<=c&&void 0!==a[c]?(g=a[c]!==
e?!0:!1)&&a.splice(c,1,e):(a.push(e),g=!0);return g};b.Fb.RJ=function(a){return!b.X.isValid(a)}});